<!Doctype html>
<html>
    <head>
        <title>facebook test</title>
<!--        https://graph.facebook.com/oauth/access_token?client_id=607442856100225&client_secret=bbd5d253d9d6a761db06ebbc63a2a057&grant_type=client_credentials-->
<!--        access_token=607442856100225|1PKH0ji8fyGRDC96ZGWkuQw8YHk-->
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.js"></script>
        <script type="text/javascript" src="jquery.ajax-cross-origin.min.js"></script>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/xeicon/2/xeicon.min.css">

        <style>
            *{
                margin: 0 auto;
            }
            #tab{
                padding: 20px;
                background: #4BA6BA;
                color: white;
            }
            #tab > ul{
                list-style: none;
                margin: 0px;
                padding: 0px;
            }
            #tab > ul > li{
                display: inline-block;
                margin: 3px 20px;
            }
            .card{
                padding: 20px 20px;
                background: white;
                margin: 10px auto;
                width: 50%;
                box-shadow: 0px 0px 3px rgba(0, 0, 0, 0.3);
            }
        </style>
        <script type="text/javascript">

            function get_data(res){
                //Context box initialize
                $('#test').html('');
                var count = res.data.length;

                for(var i = 0; i < count; i++){
                    var content = res.data[i];

                    var card = $('<div>').addClass('card');

                    if('message' in content){
                        var msg = content.message;
                        card.html(msg.replace(/\n/gi,"</br>"));
                        card.append('</br>');
                    }
                    if('full_picture' in content){
                        var img_url = content.full_picture;
                        card.append($('<img>').attr({'src': img_url, 'width': '80%'}));
                    }

                    var like_comment_box = $('<h4>').html('</br>');
                    if('likes' in content){
                        var likes = content.likes.data;
                        like_comment_box.append('<i class="xi-heart"></i> ' + likes.length);
                    }
                    // None Like
                    else{
                        like_comment_box.append('<i class="xi-heart"></i> ' + 0);
                    }
                    if('comments' in content){
                        var comments = content.comments.data;
                        like_comment_box.append('\t<i class="xi-message-o"></i> '+ comments.length);

                        card.append(like_comment_box);

                        var comment_box = $('<div>').html('</br>');
                        //Make Comments List
                        for(var j = 0; j < comments.length; j++){
                            comment_box.append($('<h5>').html(comments[j].message + '</br></br>'));
                        }
                        card.append(comment_box);
                    }
                    // None Comment
                    else{
                        like_comment_box.append('\t<i class="xi-message-o"></i> '+0);
                        card.append(like_comment_box);
                    }                            

                    $('#test').append(card);
                }
            }
            
            
            $(document).ready(function(){
                
                $.get('/hyubamboo', function(res){
                    get_data(res);
                });
                //한양대학교 대나무숲
                $('#bamboo').click(function(){
                    $.get('/hyubamboo', function(res){
                        get_data(res);
                    });
                });
                
                //한양대에리카 대신 전해드립니다.
                $('#daesin').click(function(){
                    $.get('/daesin', function(res){
                        get_data(res);
                    });
                });
                //한에사피
                $('#love').click(function(){
                    $.get('/love', function(res){
                        get_data(res);
                    });
                });


            });
                
            
        </script>
        
    </head>
    <body>
        <div id="tab">
            <h1>한양대학교 대나무숲</h1>
            </br>
            <ul>
                <li id="bamboo">대나무숲</li>
                <li id="daesin">한대전</li>
                <li id="love">한에사피</li>
            </ul>
        </div>
        
        <div id="test">
        </div>
        
    </body>
</html>